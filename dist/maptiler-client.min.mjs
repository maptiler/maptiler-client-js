import{llToTile as te,llToTilePx as ne}from"web-merc-projection";var ie=Object.defineProperty,re=(t,e,n)=>e in t?ie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,O=(t,e,n)=>(re(t,typeof e!="symbol"?e+"":e,n),n);function ae(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class j{constructor(){O(this,"_apiKey",""),O(this,"_fetch",ae())}set apiKey(e){this._apiKey=e}get apiKey(){return this._apiKey}set fetch(e){this._fetch=e}get fetch(){return this._fetch}}const g=new j,I={AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"},oe=new Set(Object.values(I));function se(){if(typeof navigator>"u")return Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];const t=Array.from(new Set(navigator.languages.map(e=>e.split("-")[0]))).filter(e=>oe.has(e));return t.length?t[0]:I.ENGLISH}var ce=(t,e,n)=>new Promise((r,i)=>{var a=c=>{try{s(n.next(c))}catch(l){i(l)}},o=c=>{try{s(n.throw(c))}catch(l){i(l)}},s=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,o);s((n=n.apply(t,e)).next())});function R(t){return ce(this,arguments,function*(e,n={}){if(g.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(e).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return g.fetch(e,n)})}const f={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(f);class v extends Error{constructor(e,n=""){super(`Call to enpoint ${e.url} failed with the status code ${e.status}. ${n}`),this.res=e}}var S=(t,e,n)=>new Promise((r,i)=>{var a=c=>{try{s(n.next(c))}catch(l){i(l)}},o=c=>{try{s(n.throw(c))}catch(l){i(l)}},s=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,o);s((n=n.apply(t,e)).next())});const T={400:"Query too long / Invalid parameters",403:"Key is missing, invalid or restricted"};function M(t,e){if(e.language==null)return;const n=Array.from(new Set((Array.isArray(e.language)?e.language:[e.language]).map(r=>r===I.AUTO?se():r))).join(",");t.set("language",n)}function H(t,e){var n;t.set("key",(n=e.apiKey)!=null?n:g.apiKey),e.limit!=null&&t.set("limit",String(e.limit)),e.types!=null&&t.set("types",e.types.join(",")),M(t,e)}function V(t,e){H(t,e),e.bbox!=null&&t.set("bbox",e.bbox.join(",")),e.proximity!=null&&t.set("proximity",e.proximity.join(",")),e.country!=null&&t.set("country",e.country.join(",")),e.fuzzyMatch!=null&&t.set("fuzzyMatch",e.fuzzyMatch?"true":"false"),e.autocomplete!=null&&t.set("autocomplete",e.autocomplete?"true":"false")}function le(t){return S(this,arguments,function*(e,n={}){var r;if(typeof e!="string"||e.trim().length===0)throw new Error("The query must be a non-empty string");const i=new URL(`geocoding/${encodeURIComponent(e)}.json`,f.maptilerApiURL),{searchParams:a}=i;V(a,n);const o=i.toString(),s=yield R(o);if(!s.ok)throw new v(s,(r=T[s.status])!=null?r:"");return yield s.json()})}function ue(t){return S(this,arguments,function*(e,n={}){var r;if(!Array.isArray(e)||e.length<2)throw new Error("The position must be an array of form [lng, lat].");const i=new URL(`geocoding/${e[0]},${e[1]}.json`,f.maptilerApiURL);H(i.searchParams,n);const a=i.toString(),o=yield R(a);if(!o.ok)throw new v(o,(r=T[o.status])!=null?r:"");return yield o.json()})}function pe(t){return S(this,arguments,function*(e,n={}){var r;const i=new URL(`geocoding/${e}.json`,f.maptilerApiURL);M(i.searchParams,n);const a=i.toString(),o=yield R(a);if(!o.ok)throw new v(o,(r=T[o.status])!=null?r:"");return yield o.json()})}function me(t){return S(this,arguments,function*(e,n={}){var r;if(!e.length)return[];const i=e.map(m=>encodeURIComponent(m)).join(";"),a=new URL(`geocoding/${i}.json`,f.maptilerApiURL),{searchParams:o}=a;V(o,n);const s=a.toString(),c=yield R(s);if(!c.ok)throw new v(c,(r=T[c.status])!=null?r:"");const l=yield c.json();return e.length===1?[l]:l})}const he={forward:le,reverse:ue,byId:pe,batch:me,language:I};var de=(t,e,n)=>new Promise((r,i)=>{var a=c=>{try{s(n.next(c))}catch(l){i(l)}},o=c=>{try{s(n.throw(c))}catch(l){i(l)}},s=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,o);s((n=n.apply(t,e)).next())});const G={403:"Key is missing, invalid or restricted"};function fe(){return de(this,arguments,function*(t={}){var e;const n=new URL("geolocation/ip.json",f.maptilerApiURL);n.searchParams.set("key",(e=t.apiKey)!=null?e:g.apiKey);const r=n.toString(),i=yield R(r);if(!i.ok)throw new v(i,i.status in G?G[i.status]:"");return yield i.json()})}const ge={info:fe};var F=(t,e,n)=>new Promise((r,i)=>{var a=c=>{try{s(n.next(c))}catch(l){i(l)}},o=c=>{try{s(n.throw(c))}catch(l){i(l)}},s=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,o);s((n=n.apply(t,e)).next())});const U={403:"Key is missing, invalid or restricted"};function ye(t){return F(this,arguments,function*(e,n={}){var r;if(typeof e!="string"||e.trim().length===0)throw new Error("The query must be a non-empty string");const i=new URL(`coordinates/search/${e}.json`,f.maptilerApiURL);i.searchParams.set("key",(r=n.apiKey)!=null?r:g.apiKey),"limit"in n&&i.searchParams.set("limit",n.limit.toString()),"transformations"in n&&i.searchParams.set("transformations",n.transformations.toString()),"exports"in n&&i.searchParams.set("exports",n.exports.toString());const a=i.toString(),o=yield R(a);if(!o.ok)throw new v(o,o.status in U?U[o.status]:"");return yield o.json()})}function ve(t){return F(this,arguments,function*(e,n={}){var r;const i=(Array.isArray(e[0])?e:[e]).map(c=>`${c[0]},${c[1]}`).join(";"),a=new URL(`coordinates/transform/${i}.json`,f.maptilerApiURL);a.searchParams.set("key",(r=n.apiKey)!=null?r:g.apiKey),"sourceCrs"in n&&a.searchParams.set("s_srs",n.sourceCrs.toString()),"targetCrs"in n&&a.searchParams.set("t_srs",n.targetCrs.toString()),"operations"in n&&a.searchParams.set("ops",(Array.isArray(n.operations)?n.operations:[n.operations]).join("|"));const o=a.toString(),s=yield R(o);if(!s.ok)throw new v(s,s.status in U?U[s.status]:"");return yield s.json()})}const Ae={search:ye,transform:ve};var Re=(t,e,n)=>new Promise((r,i)=>{var a=c=>{try{s(n.next(c))}catch(l){i(l)}},o=c=>{try{s(n.throw(c))}catch(l){i(l)}},s=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,o);s((n=n.apply(t,e)).next())});const z={403:"Key is missing, invalid or restricted"};function Le(t){return Re(this,arguments,function*(e,n={}){var r;if(typeof e!="string"||e.trim().length===0)throw new Error("The data ID must be a non-empty string");const i=new URL(`data/${encodeURIComponent(e)}/features.json`,f.maptilerApiURL);i.searchParams.set("key",(r=n.apiKey)!=null?r:g.apiKey);const a=i.toString(),o=yield R(a);if(!o.ok)throw new v(o,o.status in z?z[o.status]:"");return yield o.json()})}const Ie={get:Le};var Se=Object.defineProperty,Te=(t,e,n)=>e in t?Se(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,B=(t,e,n)=>(Te(t,typeof e!="symbol"?e+"":e,n),n);function W(t){const e=/^maptiler:\/\/(.*)/;let n;const r=t.trim();let i;return r.startsWith("http://")||r.startsWith("https://")?i=r:(n=e.exec(r))!==null?i=`https://api.maptiler.com/maps/${n[1]}/style.json`:i=`https://api.maptiler.com/maps/${r}/style.json`,i}class P{constructor(e,n,r,i,a,o){this.name=e,this.variantType=n,this.id=r,this.referenceStyle=i,this.description=a,this.imageURL=o}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(e){return this.referenceStyle.hasVariant(e)}getVariant(e){return this.referenceStyle.getVariant(e)}getVariants(){return this.referenceStyle.getVariants().filter(e=>e!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return W(this.getId())}}class w{constructor(e,n){this.name=e,this.id=n,B(this,"variants",{}),B(this,"orderedVariants",[])}getName(){return this.name}getId(){return this.id}addVariant(e){this.variants[e.getType()]=e,this.orderedVariants.push(e)}hasVariant(e){return e in this.variants}getVariant(e){return e in this.variants?this.variants[e]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const D=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function Ue(t){return new Proxy(t,{get(e,n,r){return e.hasVariant(n)?e.getVariant(n):n.toString().toUpperCase()===n?t.getDefaultVariant():Reflect.get(e,n,r)}})}function De(){const t={};for(let e=0;e<D.length;e+=1){const n=D[e],r=Ue(new w(n.name,n.referenceStyleID));for(let i=0;i<n.variants.length;i+=1){const a=n.variants[i],o=new P(a.name,a.variantType,a.id,r,a.description,a.imageURL);r.addVariant(o)}t[n.referenceStyleID]=r}return t}function N(t){if(!t)return _[D[0].referenceStyleID].getDefaultVariant().getId();if(typeof t=="string"||t instanceof String)return t.trim().toLowerCase();if(t instanceof P)return t.getId();if(t instanceof w)return t.getDefaultVariant().getId()}const _=De();function $e(t,e,n){let r=e[0],i=e[1],a=n[0]-r,o=n[1]-i;if(a!==0||o!==0){const s=((t[0]-r)*a+(t[1]-i)*o)/(a*a+o*o);s>1?(r=n[0],i=n[1]):s>0&&(r+=a*s,i+=o*s)}return a=t[0]-r,o=t[1]-i,a*a+o*o}function b(t,e,n,r,i){let a=r,o;for(let s=e+1;s<n;s++){const c=$e(t[s],t[e],t[n]);c>a&&(o=s,a=c)}a>r&&(o-e>1&&b(t,e,o,r,i),i.push(t[o]),n-o>1&&b(t,o,n,r,i))}function Ee(t,e){const n=t.length-1,r=[t[0]];return b(t,0,n,e,r),r.push(t[n]),r}function ke(t,e){if(t.length<=2)return t;const n=e!==void 0?e*e:1;return Ee(t,n)}function C(t,e=!0){let n=`${t[0]},${t[1]}`;return t.length===3&&e&&(n+=`,${t[2]}`),n}function K(t,e=3e3){let n=t.map(a=>a.join(",")).join("|"),r=5e-6;const i=1e-5;for(;n.length>e;)n=ke(t,r).map(a=>`${a[0]},${a[1]}`).join("|"),r+=i;return n}function Pe(t,e,n={}){var r,i,a,o,s;const c=N(n.style),l=n.hiDPI?"@2x":"",m=(r=n.format)!=null?r:"png";let h=~~((i=n.width)!=null?i:1024),p=~~((a=n.height)!=null?a:1024);n.hiDPI&&(h=~~(h/2),p=~~(p/2));const u=new URL(`maps/${encodeURIComponent(c)}/static/${t[0]},${t[1]},${e}/${h}x${p}${l}.${m}`,f.maptilerApiURL);if("attribution"in n&&u.searchParams.set("attribution",n.attribution.toString()),"markers"in n){let d="";const y="markerIcon"in n;y&&(d+=`icon:${n.markerIcon}|`),y&&"markerAnchor"in n&&(d+=`anchor:${n.markerAnchor}|`),y&&n.hiDPI&&(d+="scale:2|");const k=Array.isArray(n.markers[0])?n.markers:[n.markers];d+=k.map(ee=>C(ee,!y)).join("|"),u.searchParams.set("markers",d)}if("path"in n){let d="";if(d+=`fill:${(o=n.pathFillColor)!=null?o:"none"}|`,"pathStrokeColor"in n&&(d+=`stroke:${n.pathStrokeColor}|`),"pathWidth"in n){const y=n.pathWidth/(n.hiDPI?2:1);d+=`width:${y.toString()}|`}d+=K(n.path),u.searchParams.set("path",d)}return u.searchParams.set("key",(s=n.apiKey)!=null?s:g.apiKey),u.toString()}function we(t,e={}){var n,r,i,a,o;const s=N(e.style),c=e.hiDPI?"@2x":"",l=(n=e.format)!=null?n:"png";let m=~~((r=e.width)!=null?r:1024),h=~~((i=e.height)!=null?i:1024);e.hiDPI&&(m=~~(m/2),h=~~(h/2));const p=new URL(`maps/${encodeURIComponent(s)}/static/${t[0]},${t[1]},${t[2]},${t[3]}/${m}x${h}${c}.${l}`,f.maptilerApiURL);if("attribution"in e&&p.searchParams.set("attribution",e.attribution.toString()),"padding"in e&&p.searchParams.set("padding",e.padding.toString()),"markers"in e){let u="";const d="markerIcon"in e;d&&(u+=`icon:${e.markerIcon}|`),d&&"markerAnchor"in e&&(u+=`anchor:${e.markerAnchor}|`),d&&e.hiDPI&&(u+="scale:2|");const y=Array.isArray(e.markers[0])?e.markers:[e.markers];u+=y.map(k=>C(k,!d)).join("|"),p.searchParams.set("markers",u)}if("path"in e){let u="";if(u+=`fill:${(a=e.pathFillColor)!=null?a:"none"}|`,"pathStrokeColor"in e&&(u+=`stroke:${e.pathStrokeColor}|`),"pathWidth"in e){const d=e.pathWidth/(e.hiDPI?2:1);u+=`width:${d.toString()}|`}u+=K(e.path),p.searchParams.set("path",u)}return p.searchParams.set("key",(o=e.apiKey)!=null?o:g.apiKey),p.toString()}function Ne(t={}){var e,n,r,i,a;if(!("markers"in t)&&!("path"in t))throw new Error("Automatic static maps require markers and/or path to be created.");const o=N(t.style),s=t.hiDPI?"@2x":"",c=(e=t.format)!=null?e:"png";let l=~~((n=t.width)!=null?n:1024),m=~~((r=t.height)!=null?r:1024);t.hiDPI&&(l=~~(l/2),m=~~(m/2));const h=new URL(`maps/${encodeURIComponent(o)}/static/auto/${l}x${m}${s}.${c}`,f.maptilerApiURL);if("attribution"in t&&h.searchParams.set("attribution",t.attribution.toString()),"padding"in t&&h.searchParams.set("padding",t.padding.toString()),"markers"in t){let p="";const u="markerIcon"in t;u&&(p+=`icon:${t.markerIcon}|`),u&&"markerAnchor"in t&&(p+=`anchor:${t.markerAnchor}|`),u&&t.hiDPI&&(p+="scale:2|");const d=Array.isArray(t.markers[0])?t.markers:[t.markers];p+=d.map(y=>C(y,!u)).join("|"),h.searchParams.set("markers",p)}if("path"in t){let p="";if(p+=`fill:${(i=t.pathFillColor)!=null?i:"none"}|`,"pathStrokeColor"in t&&(p+=`stroke:${t.pathStrokeColor}|`),"pathWidth"in t){const u=t.pathWidth/(t.hiDPI?2:1);p+=`width:${u.toString()}|`}p+=K(t.path),h.searchParams.set("path",p)}return h.searchParams.set("key",(a=t.apiKey)!=null?a:g.apiKey),h.toString()}const be={centered:Pe,bounded:we,automatic:Ne};var Ce=Math.pow;const $=63710088e-1;function A(t){return t*3.28084}function L(t){return t%360*Math.PI/180}function Ke(t){return t*180/Math.PI}function q(t,e,n=512){return Math.cos(t*Math.PI/180)*2*Math.PI*6378137/(n*Ce(2,e))*3}function Z(t,e,n){return((1<<n)*e+t)*32+n}function xe(t){const e="geometry"in t?t.geometry:t;return e.type==="MultiPolygon"?Y(e.coordinates):x(e.coordinates)}function Y(t){const e="coordinates"in t?t.coordinates:t;let n=0;for(const r of e)n+=x(r);return n}function x(t){const e="coordinates"in t?t.coordinates:t;let n=0;for(const r of e)n+=Oe(r);return n}function Oe(t){let e,n,r,i,a,o,s,c=0;const l=t.length;if(l>2){for(s=0;s<l;s++)s===l-2?(i=l-2,a=l-1,o=0):s===l-1?(i=l-1,a=0,o=1):(i=s,a=s+1,o=s+2),e=t[i],n=t[a],r=t[o],c+=(L(r[0])-L(e[0]))*Math.sin(L(n[1]));c=c*$*$/2}return Math.abs(c)}function je(t){const e="geometry"in t?t.geometry.coordinates:"coordinates"in t?t.coordinates:t;let n=0,r;for(const i of e)r!==void 0&&(n+=E(r,i)),r=i;return n}function E(t,e){const{pow:n,sin:r,cos:i,sqrt:a,atan2:o}=Math,s=L(e[1]-t[1]),c=L(e[0]-t[0]),l=L(t[1]),m=L(e[1]),h=n(r(s/2),2)+n(r(c/2),2)*i(l)*i(m);return 2*o(a(h),a(1-h))*$}function Me(t,e,n){const r=new Map,i=[],a=[],o=q(t[0][1],e,n),s=He(t,o);for(const c of s){const l=c,[m,h]=te(l,e,n),p=Z(m,h,e),u={id:p,x:m,y:h,z:e};r.set(p,u),a.push({coordinate:l,tile:u})}for(const c of r.values())i.push(c);return{coords:a,tiles:i}}function He(t,e){const n=[];let r;for(const i of t){if(r!==void 0){const a=E(r,i),o=Math.ceil(a/e);for(let s=0;s<=o-1;s++){const c=[r[0]+(i[0]-r[0])*(s/o),r[1]+(i[1]-r[1])*(s/o)];n.push(c)}}else n.push(i);r=i}return n}function Ve(t,e,n,r,i=Q){const{channels:a,image:o}=r;let[s,c]=ne(t,e,n);s=J(s,n),c=J(c,n);const l=(c*n+s)*a;return i(o[l],o[l+1],o[l+2],a===4?o[l+3]:0)}function J(t,e){return Math.max(0,Math.min(e,Math.floor(t*e)))}function Q(t,e,n){return-1e4+(t*256*256+e*256+n)*.1}var X=(t,e,n)=>new Promise((r,i)=>{var a=c=>{try{s(n.next(c))}catch(l){i(l)}},o=c=>{try{s(n.throw(c))}catch(l){i(l)}},s=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,o);s((n=n.apply(t,e)).next())});function Ge(t,e){return X(this,null,function*(){var n,r,i;const a="geometry"in t?t.geometry.coordinates:t.coordinates,{coords:o,tiles:s}=Me(a,(n=e.zoom)!=null?n:13,(r=e.tileSize)!=null?r:512),c=yield Fe(s,e.tileRequest);let l=ze(o,c,(i=e.tileSize)!=null?i:512,e.elevationParser);e.smooth===!0&&(l=We(l));let m=Be(l);return e.metric==="ft"&&(m=_e(m)),m})}function Fe(t,e){return X(this,null,function*(){const n=new Map,r=[];for(const i of t)r.push(e(i.x,i.y,i.z).then(a=>(n.set(i.id,a),a)).catch(a=>{console.error(a)}));return yield Promise.allSettled(r),n})}function ze(t,e,n,r){const i=[];let a=0,o;for(const{tile:s,coordinate:c}of t){const l=e.get(s.id);if(l===void 0)throw new Error(`Missing tile ${s.id} (${s.x}-${s.y}-${s.z})`);const m=Ve(c,[s.z,s.x,s.y],n,l,r);i.push({distance:a,elevation:m,coordinate:c,tile:s}),o!==void 0&&(a+=E(o,c)),o=c}return i}function Be(t){let e=1/0,n=-1/0,r=0;for(const i of t)i.elevation<e&&(e=i.elevation),i.elevation>n&&(n=i.elevation),r+=i.elevation;return{distance:t[t.length-1].distance,minElevation:e,maxElevation:n,avgElevation:r/t.length,startElevation:t[0].elevation,endElevation:t[t.length-1].elevation,points:t}}function We(t){var e;const n=[];let r;for(let i=0;i<t.length;i++){const a=t[i],o=(e=t[i+1])!=null?e:t[i];if(r===void 0)n.push(a);else{const s={distance:a.distance,elevation:(r.elevation+a.elevation+o.elevation)/3,coordinate:a.coordinate,tile:a.tile};n.push(s)}r=a}return n}function _e(t){return{distance:A(t.distance),minElevation:A(t.minElevation),maxElevation:A(t.maxElevation),avgElevation:A(t.avgElevation),startElevation:A(t.startElevation),endElevation:A(t.endElevation),points:t.points.map(({distance:e,elevation:n,coordinate:r,tile:i})=>({distance:A(e),elevation:A(n),coordinate:r,tile:i}))}}export{j as ClientConfig,I as LanguageGeocoding,_ as MapStyle,P as MapStyleVariant,w as ReferenceMapStyle,v as ServiceError,xe as area,g as config,Ae as coordinates,Ie as data,Q as defaultElevationParser,L as degToRad,$ as earthRadius,W as expandMapStyle,he as geocoding,ge as geolocation,q as getZoomLevelResolution,je as lineDistance,A as mToFt,D as mapStylePresetList,Y as multiPolygonArea,E as pointDistance,x as polygonArea,Ge as profileLineString,Ke as radToDeg,be as staticMaps,Z as xyzToTileID};
